{
    "generation": "boolean process(Token t, HtmlTreeBuilder tb) {\n    switch (t.type) {\n        // \u2026 all other cases remain unchanged \u2026\n\n        case StartTag:\n            Token.StartTag startTag = t.asStartTag();\n            String name = startTag.name();\n\n            // \u2026 other start-tag handlers \u2026\n\n            else if (StringUtil.in(name,\n                    \"address\", \"article\", \"aside\", \"blockquote\", \"center\", \"details\", \"dir\", \"div\", \"dl\",\n                    \"fieldset\", \"figcaption\", \"figure\", \"footer\", \"header\", \"hgroup\", \"menu\", \"nav\", \"ol\",\n                    \"p\", \"section\", \"summary\", \"ul\")) {\n                // FIX: if an <a> is still open, close it before creating a new <p>,\n                // then reopen it inside that <p> so that a later </a> closes the inner one.\n                boolean hadA = tb.getActiveFormattingElement(\"a\") != null;\n                Attributes aAttrs = null;\n                if (hadA) {\n                    Element aEl = tb.getActiveFormattingElement(\"a\");\n                    // clone the attributes\n                    aAttrs = new Attributes();\n                    for (Attribute attr : aEl.attributes()) {\n                        aAttrs.put(attr);\n                    }\n                    // close the outer <a>\n                    tb.process(new Token.EndTag(\"a\"));\n                }\n\n                // now do the normal <p> insertion\n                if (tb.inButtonScope(\"p\")) {\n                    tb.process(new Token.EndTag(\"p\"));\n                }\n                tb.insert(startTag);\n\n                // if we closed an <a>, reopen it inside the new <p>\n                if (hadA) {\n                    tb.process(new Token.StartTag(\"a\", aAttrs));\n                }\n            }\n\n            // \u2026 the rest of your StartTag handlers remain unchanged \u2026\n\n            break;\n\n        // \u2026 EndTag, EOF, etc. remain unchanged \u2026\n    }\n    return true;\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": false,
    "test": false
}