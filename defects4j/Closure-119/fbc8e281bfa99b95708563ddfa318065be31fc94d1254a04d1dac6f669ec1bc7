{
    "generation": "@Override\npublic void collect(JSModule module, Scope scope, Node n) {\n  Node parent = n.getParent();\n\n  // --- START FIX: Do not treat the catch\u2010exception parameter as a global ---\n  // If we're inside a catch clause, and this NAME or GETPROP\n  // refers to the catch\u2010parameter, skip it entirely.\n  if (n.getType() == Token.NAME) {\n    // e.g. `catch (e) { ... }`\n    Node maybeCatch = n;\n    while (maybeCatch != null && maybeCatch.getType() != Token.CATCH) {\n      maybeCatch = maybeCatch.getParent();\n    }\n    if (maybeCatch != null) {\n      Node catchParam = maybeCatch.getFirstChild();\n      if (catchParam != null\n          && catchParam.isName()\n          && catchParam.getString().equals(n.getString())) {\n        return;\n      }\n    }\n  } else if (n.getType() == Token.GETPROP) {\n    // e.g. property on e inside catch: `e.name`\n    // find the root of the GETPROP chain\n    Node root = n;\n    while (root.getType() == Token.GETPROP) {\n      root = root.getFirstChild();\n    }\n    if (root.isName()) {\n      Node maybeCatch = n;\n      while (maybeCatch != null && maybeCatch.getType() != Token.CATCH) {\n        maybeCatch = maybeCatch.getParent();\n      }\n      if (maybeCatch != null) {\n        Node catchParam = maybeCatch.getFirstChild();\n        if (catchParam != null\n            && catchParam.isName()\n            && catchParam.getString().equals(root.getString())) {\n          return;\n        }\n      }\n    }\n  }\n  // --- END FIX -----------------------------------------------------------\n\n  String name;\n  boolean isSet = false;\n  Name.Type type = Name.Type.OTHER;\n  boolean isPropAssign = false;\n\n  switch (n.getType()) {\n    case Token.GETTER_DEF:\n    case Token.SETTER_DEF:\n    case Token.STRING_KEY:\n      // This may be a key in an object literal declaration.\n      name = null;\n      if (parent != null && parent.isObjectLit()) {\n        name = getNameForObjLitKey(n);\n      }\n      if (name == null) {\n        return;\n      }\n      isSet = true;\n      switch (n.getType()) {\n        case Token.STRING_KEY:\n          type = getValueType(n.getFirstChild());\n          break;\n        case Token.GETTER_DEF:\n          type = Name.Type.GET;\n          break;\n        case Token.SETTER_DEF:\n          type = Name.Type.SET;\n          break;\n        default:\n          throw new IllegalStateException(\"unexpected:\" + n);\n      }\n      break;\n\n    case Token.NAME:\n      // This may be a variable get or set.\n      if (parent != null) {\n        switch (parent.getType()) {\n          case Token.VAR:\n            isSet = true;\n            Node rvalue = n.getFirstChild();\n            type = (rvalue == null) ? Name.Type.OTHER\n                                   : getValueType(rvalue);\n            break;\n          case Token.ASSIGN:\n            if (parent.getFirstChild() == n) {\n              isSet = true;\n              type = getValueType(n.getNext());\n            }\n            break;\n          case Token.GETPROP:\n            return;\n          case Token.FUNCTION:\n            Node gramps = parent.getParent();\n            if (gramps == null || NodeUtil.isFunctionExpression(parent)) {\n              return;\n            }\n            isSet = true;\n            type = Name.Type.FUNCTION;\n            break;\n          case Token.INC:\n          case Token.DEC:\n            isSet = true;\n            type = Name.Type.OTHER;\n            break;\n          default:\n            if (NodeUtil.isAssignmentOp(parent)\n                && parent.getFirstChild() == n) {\n              isSet = true;\n              type = Name.Type.OTHER;\n            }\n        }\n      }\n      name = n.getString();\n      break;\n\n    case Token.GETPROP:\n      // This may be a namespaced name get or set.\n      if (parent != null) {\n        switch (parent.getType()) {\n          case Token.ASSIGN:\n            if (parent.getFirstChild() == n) {\n              isSet = true;\n              type = getValueType(n.getNext());\n              isPropAssign = true;\n            }\n            break;\n          case Token.INC:\n          case Token.DEC:\n            isSet = true;\n            type = Name.Type.OTHER;\n            break;\n          case Token.GETPROP:\n            return;\n          default:\n            if (NodeUtil.isAssignmentOp(parent)\n                && parent.getFirstChild() == n) {\n              isSet = true;\n              type = Name.Type.OTHER;\n            }\n        }\n      }\n      name = n.getQualifiedName();\n      if (name == null) {\n        return;\n      }\n      break;\n\n    default:\n      return;\n  }\n\n  // We are only interested in global names.\n  if (!isGlobalNameReference(name, scope)) {\n    return;\n  }\n\n  if (isSet) {\n    if (isGlobalScope(scope)) {\n      handleSetFromGlobal(\n          module, scope, n, parent, name, isPropAssign, type);\n    } else {\n      handleSetFromLocal(module, scope, n, parent, name);\n    }\n  } else {\n    handleGet(module, scope, n, parent, name);\n  }\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": false,
    "test": false
}