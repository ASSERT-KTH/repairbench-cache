{
    "generation": "public List<Connection.KeyVal> formData() {\n    ArrayList<Connection.KeyVal> data = new ArrayList<>();\n\n    // Instead of iterating over a potentially stale 'elements' internal list,\n    // dynamically select form controls from the live DOM tree.\n    // This ensures that elements removed from the form are no longer included\n    // in the form data.\n    Elements controls = select(\"input[name], textarea[name], select[name], button[name]\");\n\n    for (Element el : controls) {\n        // Skip disabled elements and elements without a name attribute\n        if (!el.hasAttr(\"name\") || el.hasAttr(\"disabled\")) {\n            continue;\n        }\n\n        String name = el.attr(\"name\");\n        String tagName = el.tagName();\n\n        if (\"input\".equals(tagName)) {\n            String type = el.attr(\"type\").toLowerCase();\n            if (\"radio\".equals(type) || \"checkbox\".equals(type)) {\n                // Only add checked radio and checkboxes\n                if (!el.hasAttr(\"checked\")) {\n                    continue;\n                }\n            } else if (\"file\".equals(type)) {\n                // File inputs cannot be represented by a simple KeyVal, skip\n                continue;\n            }\n            // For other input types (text, password, hidden, submit, etc.),\n            // fall through to be added to data\n        } else if (\"select\".equals(tagName)) {\n            Elements options = el.select(\"option[selected]\");\n            boolean found = false;\n            for (Element option : options) {\n                data.add(Connection.KeyVal.create(name, option.val()));\n                found = true;\n            }\n            // If no option is selected (e.g., first option not marked selected),\n            // and it's not a multiple select, submit the first option's value.\n            // This is standard HTML form behavior.\n            if (!found) {\n                Element firstOption = el.selectFirst(\"option\");\n                if (firstOption != null) {\n                    data.add(Connection.KeyVal.create(name, firstOption.val()));\n                }\n            }\n            continue; // Handled select element, move to the next control\n        }\n        // Add other form controls (textareas, buttons, non-file inputs)\n        data.add(Connection.KeyVal.create(name, el.val()));\n    }\n    return data;\n}",
    "exact_match": false,
    "ast_match": false,
    "compile": false,
    "test": false
}