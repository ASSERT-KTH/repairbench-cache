{
    "generation": "    public static Locale toLocale(String str) {\n        if (str == null) {\n            return null;\n        }\n        int len = str.length();\n        if (len != 2 && len != 5 && !(len >= 7)) {\n            throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n        }\n        char ch0 = str.charAt(0);\n        char ch1 = str.charAt(1);\n        if (ch0 < 'a' || ch0 > 'z' || ch1 < 'a' || ch1 > 'z') {\n            throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n        }\n        if (len == 2) {\n            return new Locale(str, \"\");\n        } else {\n            if (str.charAt(2) != '_') {\n                throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n            }\n            if (len == 5) {\n                char ch3 = str.charAt(3);\n                char ch4 = str.charAt(4);\n                if (ch3 < 'A' || ch3 > 'Z' || ch4 < 'A' || ch4 > 'Z') {\n                    throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n                }\n                return new Locale(str.substring(0, 2), str.substring(3, 5));\n            } else {\n                if (str.charAt(2) != '_') {\n                    throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n                }\n                // Handle cases where country code is missing (empty between underscores)\n                int countryStart = 3;\n                int countryEnd = 3;\n                int variantStart = 0;\n                // Find country code (2 chars) if present\n                if (len >= 5) {\n                    char ch3 = str.charAt(3);\n                    char ch4 = str.charAt(4);\n                    if (ch3 >= 'A' && ch3 <= 'Z' && ch4 >= 'A' && ch4 <= 'Z') {\n                        countryEnd = 5;\n                    }\n                }\n                // Check for variant separator\n                int variantSeparator = countryEnd == 5 ? 5 : 3; // after country code or after empty country\n                if (len > variantSeparator && str.charAt(variantSeparator) == '_') {\n                    variantStart = variantSeparator + 1;\n                    if (variantStart <= len) {\n                        return new Locale(str.substring(0, 2),\n                            countryEnd == 5 ? str.substring(3, 5) : \"\",\n                            str.substring(variantStart));\n                    }\n                }\n                // If we get here, it's invalid format\n                throw new IllegalArgumentException(\"Invalid locale format: \" + str);\n            }\n        }\n    }",
    "exact_match": false,
    "ast_match": false,
    "compile": true,
    "test": true
}