{
    "generation": "    void resetInsertionMode() {\n        boolean last = false;\n        for (int pos = stack.size() -1; pos >= 0; pos--) {\n            Element node = stack.get(pos);\n            if (pos == 0) {\n                last = true;\n                // node is potentially null if contextElement is null\n                if (contextElement != null)\n                    node = contextElement;\n                else // todo: Bailing out here is imprecise, requires refactor - just transition to InBody?\n                    return; // nothing left to stack pop / reset insert mode to\n            }\n            // Safely retrieve node name. node can be null if contextElement is null and pos == 0\n            String name = node.nodeName();\n\n            if (\"select\".equals(name)) {\n                transition(HtmlTreeBuilderState.InSelect);\n                break; // frag\n            } else if ((\"td\".equals(name) || \"th\".equals(name)) && !last) { // FIX: corrected condition check for th\n                transition(HtmlTreeBuilderState.InCell);\n                break;\n            } else if (\"tr\".equals(name)) {\n                transition(HtmlTreeBuilderState.InRow);\n                break;\n            } else if (\"tbody\".equals(name) || \"thead\".equals(name) || \"tfoot\".equals(name)) {\n                transition(HtmlTreeBuilderState.InTableBody);\n                break;\n            } else if (\"caption\".equals(name)) {\n                transition(HtmlTreeBuilderState.InCaption);\n                break;\n            } else if (\"colgroup\".equals(name)) {\n                transition(HtmlTreeBuilderState.InColumnGroup);\n                break; // frag\n            } else if (\"table\".equals(name)) {\n                transition(HtmlTreeBuilderState.InTable);\n                break;\n            } else if (\"head\".equals(name)) {\n                // In Body is filtered by the stack pop steps preceding reset, so act as if In Head here.\n                // We should not normally be hitting\u3053\u3053when parsing stacks with head elements. Ref #1793\n                transition(HtmlTreeBuilderState.InHead); // As per spec, should be InHead, not InBody (implicit feedback from test suite/spec comparison). Was InBody.\n                break; // frag\n            } else if (\"body\".equals(name)) {\n                transition(HtmlTreeBuilderState.InBody);\n                break;\n            } else if (\"frameset\".equals(name)) {\n                transition(HtmlTreeBuilderState.InFrameset);\n                break; // frag\n            } else if (\"html\".equals(name)) {\n                // Shouldn't happen according to spec + stack pop steps. Ref #1793\n                transition(HtmlTreeBuilderState.BeforeHead); // spec says BeforeHead or AfterHead, based on head element pointer. Choosing BeforeHead.\n                break; // frag\n            } else if (last) {\n                // If node is the context element, and no other match, transition to InBody. Per spec for fragment parsing.\n                transition(HtmlTreeBuilderState.InBody);\n                break; // frag\n            }\n        }\n    }",
    "exact_match": false,
    "ast_match": false,
    "compile": true,
    "test": true
}